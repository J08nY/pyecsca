source 1986 Chudnovsky--Chudnovsky "Sequences of numbers generated by addition in formal groups and new primality and factorization tests", page 414, formula (4.3i)
unified
compute U1 = X1 Z2^2
compute U2 = X2 Z1^2
compute S1 = Y1 Z2^3
compute S2 = Y2 Z1^3
compute P = U2-U1
compute R = S2-S1
compute X3 = R^2-(U1+U2) P^2
compute Y3 = R (U1 P^2-X3)-S1 P^3
compute Z3 = Z1 Z2 P
